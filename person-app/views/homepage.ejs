<!DOCTYPE html>
<html>
<head>
	 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	 <title>ADR Administation App</title>
	 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	 <meta name="viewport" content="width=device-width, initial-scale=1.0">
	 <style type="text/css">
		 body{
		   padding-top: 50px;
		   padding-bottom: 50px;
		   background-color: #155137;
		}
		 .login-box {
			 max-width: 330px;
			 margin: 0 auto;
			 background-color: #DBE4EE;
			 padding: 10px;
		 }
		 .login-box .form-control {
		 	margin-bottom: 10px;
		 }
		 .button {
  	 		background-color: #ce1271;
		 }
		 .intro {
		 	margin: 0 auto;
		 	text-align: center;
		 	padding: 5px;
		 	padding-bottom: 15px;
		 }
		 .error {
		 	margin: 0 auto;
		 	text-align: center;
		 	max-width: 330px;
			padding: 10px;
		 }
	 </style>
	 <style>
	 	h1 {
        color: #FBFBFF;
			 }
		</style>
</head>

<script>

	var users;
	var usersToSearch;

  function getUsers() {
		console.log("called get users");
    fetch('/getUsers').then(async function(response) {
       users = await response.json();
			 await console.log(users);
			 await console.log("called get users");
		});
  }

// this method is used to find a user
$(document).ready(function () {
  // Listen to submit event on the <form> itself!
  $('#search').submit(function (e) {


		console.log("form submitted");

    e.preventDefault();

		var searchTerm = document.getElementById('textBoxID').value;
		document.getElementById('textBoxID').value = "";

		var length = users.users.length;
		var foundUser;

		for (var i = 0; i < length; i++) {
			var firstname = users.users[i].firstName;
			var lastname = users.users[i].lastName;
			var fullname = firstname + " " + lastname;
			if (fullname == searchTerm) {
				foundUser = users.users[i];
				console.log("found user!");
				var data = {
					email: foundUser.email,
					userType: foundUser.userType
				}
				deleteSessions(data);
			}
		}
  });
});

function deleteSessions (data) {
	$.ajax({
		type: "post",
		url: "/deleteSessions",
		data: data,
		success: function(data) {
			console.log("success?")
		}
	});

}

</script>

<body onload="getUsers()">

<body>
	<div class="intro">
		<h1 color = "white" >Welcome to the admin app!</h1>
	</div>
	<form action="/createaccount" method="post" id="signupform">
		<input type="submit" value="Navigate to Qualifications Page">
	</form>

	<form action="/complaints" method="post" id="complaints">
		<button type="complaints" class="btn button btn-lg btn-primary btn-block">Complaints</button><br>
	</form>

	<form action="/logout" method="post">
  	<button type="logout" class="btn button btn-lg btn-primary btn-block">Logout</button><br>
	</form>


	<form id = "search" class = "form-inline">
		<input type = "search" id = "textBoxID" placeholder="Search for names...">
  	<button type="submit" class="btn button btn-primary btn-block">Search</button><br>
	</form>


</body>
</html>
